<?xml version="1.0" encoding="UTF-8"?>
<project name="Tara" default="all" basedir="." xmlns:sonar="antlib:org.sonar.ant">

  <!-- ========= Define the main properties of this project ========= -->
  <property name="src.dir" defaultValue="src"/>
  <property name="test.dir" defaultValue="test"/>
  <property name="build.dir" defaultValue="out"/>
  <property name="classes.dir" defaultValue="${build.dir}"/>
  <property name="reports.dir" defaultValue="${build.dir}/reports"/>
  <property name="reports.junit.xml.dir" defaultValue="${reports.dir}/junit"/>

  <!-- Define the SonarQube properties -->
  <property name="sonar.sourceEncoding" defaultValue="UTF-8"/>
  <property name="sonar.host.url" defaultValue="http://192.168.200.88:9000"/>
  <property name="sonar.login" defaultValue="application_hudson"/>
  <loadfile property="sonar_web_password" srcfile="web.password"/>
  <property name="sonar.password" defaultValue="${sonar_web_password}"/>
  <property name="sonar.projectKey" defaultValue="tara"/>
  <property name="sonar.projectName" defaultValue="tara"/>
  <property name="sonar.projectVersion" defaultValue="1.0"/>
  <property name="sonar.language" defaultValue="java"/>
  <property name="sonar.java.source" defaultValue="1.7"/>
  <property name="sonar.java.source" defaultValue="1.7"/>
  <property name="sonar.sources" defaultValue="${src.dir}"/>
  <property name="sonar.tests" defaultValue="${test.dir}"/>
  <property name="sonar.binaries" defaultValue="${classes.dir}"/>
  <property name="sonar.surefire.reportsPath" defaultValue="${reports.junit.xml.dir}"/>
  <property name="sonar.modules" defaultValue="intellij,jps-plugin,rt,rt-constants"/>
  <property name="sonar.sourceEncoding" defaultValue="UTF-8"/>

  <!-- Override some properties at module level -->
  <property name="intellij.sonar.projectName" defaultValue="intellij"/>
  <property name="tara_runtime.sonar.projectName" defaultValue="rt"/>
  <property name="tara_runtime_constants.sonar.projectName" defaultValue="rt-constants"/>
  <property name="processor_manager.sonar.projectName" defaultValue="jps-plugin"/>


  <property name="sonar.jdbc.url" defaultValue="jdbc:mysql://192.168.200.88:3306/sonar_40?characterEncoding=utf8"/>
  <property name="sonar.jdbc.username" defaultValue="sonar"/>
  <loadfile property="sonar_mysql_password" srcfile="mysql.password"/>
  <property name="sonar.jdbc.password" defaultValue="${sonar_mysql_password}"/>

  <!-- ========= Define "regular" targets: clean, compile, test, ... ========= -->
  <target name="clean">
    <delete dir=".sonar"/>
    <ant dir="intellij" target="clean"/>
    <ant dir="rt" target="clean"/>
    <ant dir="rt-constants" target="clean"/>
    <ant dir="jps-plugin" target="clean"/>
  </target>

  <!-- ========= Define SonarQube target ========= -->
  <target name="sonar">
    <taskdef uri="antlib:org.sonar.ant" resource="org/sonar/ant/antlib.xml">
      <!-- Update the following line, or put the "sonar-ant-task-*.jar" file in your "$HOME/.ant/lib" folder -->
      <!--<classpath path="/Applications/libraries/sonar-ant-task-2.1.jar"/>-->
    </taskdef>

    <!-- Execute SonarQube -->
    <sonar:sonesperaar/>
  </target>

  <!-- ========= The main target "all" ========= -->
  <target name="all" depends="clean, sonar"/>

</project>
